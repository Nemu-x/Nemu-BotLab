# Telegram Bot Administrator

## Обзор системы

Telegram Bot Administrator - это веб-приложение, предназначенное для управления Telegram ботом. Система состоит из:

1. **Бэкенд** (Node.js + Express + Sequelize)
2. **Фронтенд** (Next.js + React)
3. **Telegram Bot API** интеграция

## Функциональность

- Управление командами бота
- Ведение диалогов с пользователями
- Опросники (Flow) для автоматического сбора информации
- Управление настройками бота
- Администрирование пользователей

## Запуск приложения

### Предварительные требования

- Node.js v18+
- npm или yarn
- Telegram Bot API токен

### Запуск бэкенда

```bash
cd telegram-bot-backend
npm install
npm run dev
```

### Запуск фронтенда

```bash
cd telegram-bot-frontend
npm install
npm run dev
```

## Опросники (Flow)

Функциональность опросников (Flow) позволяет создавать интерактивные последовательности сообщений для сбора информации от пользователей Telegram.

### Создание опросника

1. Перейдите в раздел "Опросники" в панели администратора
2. Нажмите кнопку "Создать опросник"
3. Заполните информацию:
   - Название опросника
   - Описание
   - Настройте начальную команду

### Добавление шагов опросника

1. Для каждого шага опросника нажмите "Добавить шаг"
2. Заполните поля:
   - Текст вопроса
   - Тип ожидаемого ответа
   - Варианты ответов (если применимо)
   - Следующий шаг

### Ветвление и условия

- Вы можете создавать условия для перехода к разным шагам в зависимости от ответа пользователя
- Настройте эти условия в разделе "Условия" каждого шага

### Просмотр результатов

Результаты опросников доступны в профиле каждого клиента в разделе "Данные опросов".

## Исправление типичных проблем

### Проблема 1: Ошибка "Failed to fetch clients"

Эта ошибка возникает из-за несоответствия структуры базы данных и моделей Sequelize. 

**Решение:**
1. Убедитесь, что все необходимые миграции выполнены
2. Проверьте, что все поля, используемые в модели Client, существуют в таблице clients

### Проблема 2: Ошибка "SQLITE_ERROR: no such column"

Эта ошибка указывает на то, что в базе данных отсутствует столбец, который используется в запросе.

**Решение:**
1. Создайте миграцию для добавления отсутствующего столбца
2. Запустите миграцию с помощью команды `npm run migrate`

### Проблема 3: Не работает авторизация

**Решение:**
1. Проверьте правильность JWT токена
2. Убедитесь, что middleware аутентификации правильно сконфигурирован

## Дополнительная документация

Более подробное руководство по созданию и управлению опросниками можно найти в файле [FLOW_GUIDE.md](/home/ak/telegram-bot/FLOW_GUIDE.md). 